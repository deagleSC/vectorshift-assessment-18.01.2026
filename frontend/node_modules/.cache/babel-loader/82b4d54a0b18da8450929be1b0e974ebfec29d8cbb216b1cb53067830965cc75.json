{"ast":null,"code":"var _jsxFileName = \"/Users/supratik_personal/Downloads/frontend_technical_assessment/frontend/src/components/nodes/TextNode.jsx\",\n  _s = $RefreshSig$();\n// TextNode.jsx - Text node with dynamic handles, variable validation, and autocomplete\n\nimport { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { useEdges, useNodes } from 'reactflow';\nimport { BaseNode } from './BaseNode';\nimport { nodeConfig } from '../../config/nodeConfig';\nimport { useStore } from '../../store';\nimport { cn } from '../../lib/utils';\nimport { AlertCircle, Info } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst config = nodeConfig.text;\n\n// Extract variables from text using {{variableName}} or {{nodeId.handle}} pattern\nconst extractVariables = text => {\n  const regex = /\\{\\{([a-zA-Z_$][a-zA-Z0-9_$.-]*)\\}\\}/g;\n  const variables = new Set();\n  let match;\n  while ((match = regex.exec(text)) !== null) {\n    variables.add(match[1]);\n  }\n  return Array.from(variables);\n};\n\n// Highlighted text display component\nconst HighlightedText = ({\n  text,\n  validVars,\n  invalidVars\n}) => {\n  if (!text) return null;\n  const parts = text.split(/(\\{\\{[a-zA-Z_$][a-zA-Z0-9_$.-]*\\}\\})/g);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"whitespace-pre-wrap break-words text-[11px] font-mono leading-relaxed\",\n    children: parts.map((part, index) => {\n      const match = part.match(/^\\{\\{([a-zA-Z_$][a-zA-Z0-9_$.-]*)\\}\\}$/);\n      if (match) {\n        const varName = match[1];\n        const isValid = validVars.includes(varName);\n        const isInvalid = invalidVars.includes(varName);\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          className: cn('px-1 py-0.5 rounded text-[10px]', isValid ? 'bg-emerald-100 text-emerald-700 border border-emerald-200' : isInvalid ? 'bg-red-100 text-red-700 border border-red-200' : 'bg-amber-100 text-amber-700 border border-amber-200'),\n          children: part\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 13\n        }, this);\n      }\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-slate-600\",\n        children: part\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 16\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 5\n  }, this);\n};\n\n// Autocomplete dropdown component\n_c = HighlightedText;\nconst AutocompleteDropdown = ({\n  variables,\n  onSelect,\n  position\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"absolute z-50 bg-white border border-slate-200 rounded-md shadow-lg py-1 min-w-[220px] max-h-[200px] overflow-auto\",\n    style: {\n      top: position.top,\n      left: position.left\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-2 py-1 text-[10px] font-medium text-slate-400 uppercase border-b border-slate-100\",\n      children: \"Available Variables\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), variables.length > 0 ? variables.map((v, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => onSelect(v.fullName),\n      className: \"w-full px-2 py-1.5 text-left hover:bg-primary/5 flex items-center justify-between gap-2 transition-colors\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs font-mono text-primary font-medium\",\n        children: `{{${v.fullName}}}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-[10px] text-slate-400 bg-slate-50 px-1.5 py-0.5 rounded\",\n        children: v.nodeType\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-2 py-3 text-xs text-slate-400 text-center\",\n      children: [\"No other nodes on canvas yet.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-[10px]\",\n        children: \"Add nodes to see their outputs here.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n_c2 = AutocompleteDropdown;\nexport const TextNode = ({\n  id,\n  data,\n  selected\n}) => {\n  _s();\n  const [text, setText] = useState((data === null || data === void 0 ? void 0 : data.text) || '');\n  const [showAutocomplete, setShowAutocomplete] = useState(false);\n  const [autocompletePos, setAutocompletePos] = useState({\n    top: 0,\n    left: 0\n  });\n  const [cursorPosition, setCursorPosition] = useState(0);\n  const textareaRef = useRef(null);\n  const updateNodeField = useStore(state => state.updateNodeField);\n\n  // Use hooks that properly track changes\n  const allNodes = useNodes();\n  const allEdges = useEdges();\n\n  // Extract variables for dynamic handles\n  const variables = useMemo(() => extractVariables(text), [text]);\n\n  // Get ALL available variables from ALL other nodes in format: nodeId.outputHandle\n  const availableVariables = useMemo(() => {\n    const availableVars = [];\n    allNodes.forEach(node => {\n      // Skip self\n      if (node.id === id) return;\n      const nodeConfigItem = nodeConfig[node.type];\n      if (nodeConfigItem && nodeConfigItem.defaultOutputs) {\n        // Add output variables from this node in format: nodeId.handleId\n        nodeConfigItem.defaultOutputs.forEach(output => {\n          availableVars.push({\n            fullName: `${node.id}.${output.id}`,\n            // e.g., \"customInput-1.value\"\n            nodeId: node.id,\n            handleId: output.id,\n            handleLabel: output.label,\n            nodeType: nodeConfigItem.title,\n            type: output.type || 'Text'\n          });\n        });\n      }\n    });\n    return availableVars;\n  }, [id, allNodes]);\n\n  // Map of valid variable names\n  const validVariableNames = useMemo(() => {\n    return new Set(availableVariables.map(v => v.fullName));\n  }, [availableVariables]);\n\n  // Find which handles are connected to this node\n  const connectedHandles = useMemo(() => {\n    return allEdges.filter(e => e.target === id).map(e => e.targetHandle);\n  }, [id, allEdges]);\n\n  // Categorize variables\n  const {\n    validVars,\n    invalidVars,\n    unconnectedVars\n  } = useMemo(() => {\n    const valid = [];\n    const invalid = [];\n    const unconnected = [];\n    variables.forEach(v => {\n      if (validVariableNames.has(v)) {\n        if (connectedHandles.includes(v)) {\n          valid.push(v);\n        } else {\n          unconnected.push(v);\n        }\n      } else {\n        invalid.push(v);\n      }\n    });\n    return {\n      validVars: valid,\n      invalidVars: invalid,\n      unconnectedVars: unconnected\n    };\n  }, [variables, validVariableNames, connectedHandles]);\n\n  // Create inputs - always have a default \"input\" handle plus dynamic ones for variables\n  const allInputs = useMemo(() => {\n    const inputs = [];\n\n    // Add handles for each valid variable used\n    variables.forEach(varName => {\n      if (validVariableNames.has(varName) && !inputs.find(i => i.id === varName)) {\n        inputs.push({\n          id: varName,\n          label: varName.split('.').pop() // Show just the handle name\n        });\n      }\n    });\n\n    // Always have at least a default input handle if no variables\n    if (inputs.length === 0) {\n      inputs.push({\n        id: 'input',\n        label: 'input'\n      });\n    }\n    return inputs;\n  }, [variables, validVariableNames, availableVariables]);\n\n  // Calculate dynamic dimensions based on text content\n  const dimensions = useMemo(() => {\n    const lines = text.split('\\n');\n    const lineCount = lines.length;\n    const maxLineLength = Math.max(...lines.map(line => line.length), 0);\n    const hasWarnings = invalidVars.length > 0 || unconnectedVars.length > 0;\n    const baseWidth = 300;\n    const baseHeight = hasWarnings ? 280 : 260;\n    const charWidth = 6.5;\n    const paddingWidth = 80;\n    const lineHeight = 18;\n    const paddingHeight = hasWarnings ? 240 : 220;\n    const calculatedWidth = Math.min(Math.max(baseWidth, maxLineLength * charWidth + paddingWidth), 480);\n    const calculatedHeight = Math.min(Math.max(baseHeight, lineCount * lineHeight + paddingHeight), 450);\n    return {\n      width: calculatedWidth,\n      height: calculatedHeight\n    };\n  }, [text, invalidVars.length, unconnectedVars.length]);\n\n  // Update store when text changes\n  useEffect(() => {\n    updateNodeField(id, 'text', text);\n  }, [id, text, updateNodeField]);\n\n  // Update store with current variables\n  useEffect(() => {\n    updateNodeField(id, 'variables', variables);\n  }, [id, variables, updateNodeField]);\n\n  // Handle text input change\n  const handleTextChange = useCallback(e => {\n    const newText = e.target.value;\n    const cursorPos = e.target.selectionStart;\n    setText(newText);\n    setCursorPosition(cursorPos);\n\n    // Check if we should show autocomplete\n    const textBeforeCursor = newText.slice(0, cursorPos);\n    const lastTwoChars = textBeforeCursor.slice(-2);\n    if (lastTwoChars === '{{') {\n      const textarea = textareaRef.current;\n      if (textarea) {\n        const lineHeight = 18;\n        const lines = textBeforeCursor.split('\\n');\n        const currentLine = lines.length;\n        const top = currentLine * lineHeight + 120;\n        setAutocompletePos({\n          top,\n          left: 10\n        });\n        setShowAutocomplete(true);\n      }\n    } else {\n      setShowAutocomplete(false);\n    }\n  }, []);\n\n  // Handle autocomplete selection\n  const handleAutocompleteSelect = useCallback(varName => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      const beforeCursor = text.slice(0, cursorPosition);\n      const afterCursor = text.slice(cursorPosition);\n      const newText = beforeCursor + varName + '}}' + afterCursor;\n      setText(newText);\n      setShowAutocomplete(false);\n      setTimeout(() => {\n        textarea.focus();\n        const newCursorPos = cursorPosition + varName.length + 2;\n        textarea.setSelectionRange(newCursorPos, newCursorPos);\n      }, 0);\n    }\n  }, [text, cursorPosition]);\n\n  // Close autocomplete on blur\n  const handleBlur = useCallback(() => {\n    setTimeout(() => setShowAutocomplete(false), 200);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(BaseNode, {\n    id: id,\n    title: config.title,\n    icon: config.icon,\n    category: config.category,\n    inputs: allInputs,\n    outputs: config.defaultOutputs,\n    selected: selected,\n    minWidth: dimensions.width,\n    minHeight: dimensions.height,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2 relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-xs font-medium text-slate-500 uppercase tracking-wide\",\n        children: \"Text\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-start gap-1.5 p-1.5 bg-blue-50/50 border border-blue-100 rounded text-[10px] text-blue-600\",\n        children: [/*#__PURE__*/_jsxDEV(Info, {\n          className: \"w-3 h-3 flex-shrink-0 mt-0.5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Type \", /*#__PURE__*/_jsxDEV(\"code\", {\n            className: \"px-1 bg-blue-100 rounded\",\n            children: ['{{', \"}\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 22\n          }, this), \" to insert variables like \", /*#__PURE__*/_jsxDEV(\"code\", {\n            className: \"px-1 bg-blue-100 rounded\",\n            children: '{{nodeId.output}}'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 105\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 9\n      }, this), availableVariables.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-[10px] font-medium text-slate-400 uppercase\",\n          children: \"Available from pipeline:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-1 max-h-[60px] overflow-auto\",\n          children: availableVariables.map((v, i) => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              const newText = text + `{{${v.fullName}}}`;\n              setText(newText);\n            },\n            className: \"text-[10px] px-1.5 py-0.5 bg-slate-50 text-slate-600 border border-slate-200 rounded hover:bg-primary/5 hover:border-primary/30 hover:text-primary transition-colors cursor-pointer font-mono\",\n            title: `From ${v.nodeType} (${v.nodeId})`,\n            children: v.fullName\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: textareaRef,\n          value: text,\n          onChange: handleTextChange,\n          onBlur: handleBlur,\n          placeholder: \"Hello {{input-1.value}}! Type {{ to see variables...\",\n          className: \"w-full p-2 text-[11px] font-mono bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:bg-white focus:border-primary focus:ring-1 focus:ring-primary/20 transition-colors resize-none leading-relaxed nodrag\",\n          style: {\n            minHeight: Math.max(60, text.split('\\n').length * 18 + 10)\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), showAutocomplete && /*#__PURE__*/_jsxDEV(AutocompleteDropdown, {\n          variables: availableVariables,\n          onSelect: handleAutocompleteSelect,\n          position: autocompletePos\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this), text && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-2 bg-slate-50/50 border border-slate-100 rounded-md\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-[10px] font-medium text-slate-400 uppercase mb-1\",\n          children: \"Preview\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(HighlightedText, {\n          text: text,\n          validVars: validVars,\n          invalidVars: [...invalidVars, ...unconnectedVars]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 11\n      }, this), unconnectedVars.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-start gap-1.5 p-2 bg-amber-50 border border-amber-100 rounded-md\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          className: \"w-3.5 h-3.5 text-amber-500 flex-shrink-0 mt-0.5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-[10px] font-medium text-amber-700\",\n            children: \"Unconnected variables\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-[10px] text-amber-600\",\n            children: [unconnectedVars.map(v => `{{${v}}}`).join(', '), \" \\u2014 connect the source nodes\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 11\n      }, this), invalidVars.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-start gap-1.5 p-2 bg-red-50 border border-red-100 rounded-md\",\n        children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n          className: \"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-[10px] font-medium text-red-700\",\n            children: \"Invalid variables\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-[10px] text-red-600\",\n            children: [invalidVars.map(v => `{{${v}}}`).join(', '), \" \\u2014 no matching node output\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 274,\n    columnNumber: 5\n  }, this);\n};\n_s(TextNode, \"Q7ueP6XWFG8danZtWMm9keH6Wiw=\", false, function () {\n  return [useStore, useNodes, useEdges];\n});\n_c3 = TextNode;\nexport default TextNode;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"HighlightedText\");\n$RefreshReg$(_c2, \"AutocompleteDropdown\");\n$RefreshReg$(_c3, \"TextNode\");","map":{"version":3,"names":["useState","useEffect","useMemo","useCallback","useRef","useEdges","useNodes","BaseNode","nodeConfig","useStore","cn","AlertCircle","Info","jsxDEV","_jsxDEV","config","text","extractVariables","regex","variables","Set","match","exec","add","Array","from","HighlightedText","validVars","invalidVars","parts","split","className","children","map","part","index","varName","isValid","includes","isInvalid","fileName","_jsxFileName","lineNumber","columnNumber","_c","AutocompleteDropdown","onSelect","position","style","top","left","length","v","onClick","fullName","nodeType","_c2","TextNode","id","data","selected","_s","setText","showAutocomplete","setShowAutocomplete","autocompletePos","setAutocompletePos","cursorPosition","setCursorPosition","textareaRef","updateNodeField","state","allNodes","allEdges","availableVariables","availableVars","forEach","node","nodeConfigItem","type","defaultOutputs","output","push","nodeId","handleId","handleLabel","label","title","validVariableNames","connectedHandles","filter","e","target","targetHandle","unconnectedVars","valid","invalid","unconnected","has","allInputs","inputs","find","i","pop","dimensions","lines","lineCount","maxLineLength","Math","max","line","hasWarnings","baseWidth","baseHeight","charWidth","paddingWidth","lineHeight","paddingHeight","calculatedWidth","min","calculatedHeight","width","height","handleTextChange","newText","value","cursorPos","selectionStart","textBeforeCursor","slice","lastTwoChars","textarea","current","currentLine","handleAutocompleteSelect","beforeCursor","afterCursor","setTimeout","focus","newCursorPos","setSelectionRange","handleBlur","icon","category","outputs","minWidth","minHeight","ref","onChange","onBlur","placeholder","join","_c3","$RefreshReg$"],"sources":["/Users/supratik_personal/Downloads/frontend_technical_assessment/frontend/src/components/nodes/TextNode.jsx"],"sourcesContent":["// TextNode.jsx - Text node with dynamic handles, variable validation, and autocomplete\n\nimport { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { useEdges, useNodes } from 'reactflow';\nimport { BaseNode } from './BaseNode';\nimport { nodeConfig } from '../../config/nodeConfig';\nimport { useStore } from '../../store';\nimport { cn } from '../../lib/utils';\nimport { AlertCircle, Info } from 'lucide-react';\n\nconst config = nodeConfig.text;\n\n// Extract variables from text using {{variableName}} or {{nodeId.handle}} pattern\nconst extractVariables = (text) => {\n  const regex = /\\{\\{([a-zA-Z_$][a-zA-Z0-9_$.-]*)\\}\\}/g;\n  const variables = new Set();\n  let match;\n  while ((match = regex.exec(text)) !== null) {\n    variables.add(match[1]);\n  }\n  return Array.from(variables);\n};\n\n// Highlighted text display component\nconst HighlightedText = ({ text, validVars, invalidVars }) => {\n  if (!text) return null;\n  \n  const parts = text.split(/(\\{\\{[a-zA-Z_$][a-zA-Z0-9_$.-]*\\}\\})/g);\n  \n  return (\n    <div className=\"whitespace-pre-wrap break-words text-[11px] font-mono leading-relaxed\">\n      {parts.map((part, index) => {\n        const match = part.match(/^\\{\\{([a-zA-Z_$][a-zA-Z0-9_$.-]*)\\}\\}$/);\n        if (match) {\n          const varName = match[1];\n          const isValid = validVars.includes(varName);\n          const isInvalid = invalidVars.includes(varName);\n          return (\n            <span\n              key={index}\n              className={cn(\n                'px-1 py-0.5 rounded text-[10px]',\n                isValid\n                  ? 'bg-emerald-100 text-emerald-700 border border-emerald-200'\n                  : isInvalid\n                  ? 'bg-red-100 text-red-700 border border-red-200'\n                  : 'bg-amber-100 text-amber-700 border border-amber-200'\n              )}\n            >\n              {part}\n            </span>\n          );\n        }\n        return <span key={index} className=\"text-slate-600\">{part}</span>;\n      })}\n    </div>\n  );\n};\n\n// Autocomplete dropdown component\nconst AutocompleteDropdown = ({ variables, onSelect, position }) => {\n  return (\n    <div \n      className=\"absolute z-50 bg-white border border-slate-200 rounded-md shadow-lg py-1 min-w-[220px] max-h-[200px] overflow-auto\"\n      style={{ top: position.top, left: position.left }}\n    >\n      <div className=\"px-2 py-1 text-[10px] font-medium text-slate-400 uppercase border-b border-slate-100\">\n        Available Variables\n      </div>\n      {variables.length > 0 ? (\n        variables.map((v, index) => (\n          <button\n            key={index}\n            onClick={() => onSelect(v.fullName)}\n            className=\"w-full px-2 py-1.5 text-left hover:bg-primary/5 flex items-center justify-between gap-2 transition-colors\"\n          >\n            <span className=\"text-xs font-mono text-primary font-medium\">{`{{${v.fullName}}}`}</span>\n            <span className=\"text-[10px] text-slate-400 bg-slate-50 px-1.5 py-0.5 rounded\">{v.nodeType}</span>\n          </button>\n        ))\n      ) : (\n        <div className=\"px-2 py-3 text-xs text-slate-400 text-center\">\n          No other nodes on canvas yet.\n          <br />\n          <span className=\"text-[10px]\">Add nodes to see their outputs here.</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport const TextNode = ({ id, data, selected }) => {\n  const [text, setText] = useState(data?.text || '');\n  const [showAutocomplete, setShowAutocomplete] = useState(false);\n  const [autocompletePos, setAutocompletePos] = useState({ top: 0, left: 0 });\n  const [cursorPosition, setCursorPosition] = useState(0);\n  const textareaRef = useRef(null);\n  const updateNodeField = useStore((state) => state.updateNodeField);\n  \n  // Use hooks that properly track changes\n  const allNodes = useNodes();\n  const allEdges = useEdges();\n\n  // Extract variables for dynamic handles\n  const variables = useMemo(() => extractVariables(text), [text]);\n\n  // Get ALL available variables from ALL other nodes in format: nodeId.outputHandle\n  const availableVariables = useMemo(() => {\n    const availableVars = [];\n    \n    allNodes.forEach(node => {\n      // Skip self\n      if (node.id === id) return;\n      \n      const nodeConfigItem = nodeConfig[node.type];\n      if (nodeConfigItem && nodeConfigItem.defaultOutputs) {\n        // Add output variables from this node in format: nodeId.handleId\n        nodeConfigItem.defaultOutputs.forEach(output => {\n          availableVars.push({\n            fullName: `${node.id}.${output.id}`, // e.g., \"customInput-1.value\"\n            nodeId: node.id,\n            handleId: output.id,\n            handleLabel: output.label,\n            nodeType: nodeConfigItem.title,\n            type: output.type || 'Text',\n          });\n        });\n      }\n    });\n    \n    return availableVars;\n  }, [id, allNodes]);\n\n  // Map of valid variable names\n  const validVariableNames = useMemo(() => {\n    return new Set(availableVariables.map(v => v.fullName));\n  }, [availableVariables]);\n\n  // Find which handles are connected to this node\n  const connectedHandles = useMemo(() => {\n    return allEdges.filter(e => e.target === id).map(e => e.targetHandle);\n  }, [id, allEdges]);\n\n  // Categorize variables\n  const { validVars, invalidVars, unconnectedVars } = useMemo(() => {\n    const valid = [];\n    const invalid = [];\n    const unconnected = [];\n    \n    variables.forEach(v => {\n      if (validVariableNames.has(v)) {\n        if (connectedHandles.includes(v)) {\n          valid.push(v);\n        } else {\n          unconnected.push(v);\n        }\n      } else {\n        invalid.push(v);\n      }\n    });\n    \n    return { validVars: valid, invalidVars: invalid, unconnectedVars: unconnected };\n  }, [variables, validVariableNames, connectedHandles]);\n\n  // Create inputs - always have a default \"input\" handle plus dynamic ones for variables\n  const allInputs = useMemo(() => {\n    const inputs = [];\n    \n    // Add handles for each valid variable used\n    variables.forEach(varName => {\n      if (validVariableNames.has(varName) && !inputs.find(i => i.id === varName)) {\n        inputs.push({ \n          id: varName, \n          label: varName.split('.').pop() // Show just the handle name\n        });\n      }\n    });\n    \n    // Always have at least a default input handle if no variables\n    if (inputs.length === 0) {\n      inputs.push({ id: 'input', label: 'input' });\n    }\n    \n    return inputs;\n  }, [variables, validVariableNames, availableVariables]);\n\n  // Calculate dynamic dimensions based on text content\n  const dimensions = useMemo(() => {\n    const lines = text.split('\\n');\n    const lineCount = lines.length;\n    const maxLineLength = Math.max(...lines.map(line => line.length), 0);\n    \n    const hasWarnings = invalidVars.length > 0 || unconnectedVars.length > 0;\n    const baseWidth = 300;\n    const baseHeight = hasWarnings ? 280 : 260;\n    const charWidth = 6.5;\n    const paddingWidth = 80;\n    const lineHeight = 18;\n    const paddingHeight = hasWarnings ? 240 : 220;\n    \n    const calculatedWidth = Math.min(\n      Math.max(baseWidth, maxLineLength * charWidth + paddingWidth),\n      480\n    );\n    \n    const calculatedHeight = Math.min(\n      Math.max(baseHeight, lineCount * lineHeight + paddingHeight),\n      450\n    );\n    \n    return { width: calculatedWidth, height: calculatedHeight };\n  }, [text, invalidVars.length, unconnectedVars.length]);\n\n  // Update store when text changes\n  useEffect(() => {\n    updateNodeField(id, 'text', text);\n  }, [id, text, updateNodeField]);\n\n  // Update store with current variables\n  useEffect(() => {\n    updateNodeField(id, 'variables', variables);\n  }, [id, variables, updateNodeField]);\n\n  // Handle text input change\n  const handleTextChange = useCallback((e) => {\n    const newText = e.target.value;\n    const cursorPos = e.target.selectionStart;\n    setText(newText);\n    setCursorPosition(cursorPos);\n\n    // Check if we should show autocomplete\n    const textBeforeCursor = newText.slice(0, cursorPos);\n    const lastTwoChars = textBeforeCursor.slice(-2);\n    \n    if (lastTwoChars === '{{') {\n      const textarea = textareaRef.current;\n      if (textarea) {\n        const lineHeight = 18;\n        const lines = textBeforeCursor.split('\\n');\n        const currentLine = lines.length;\n        const top = currentLine * lineHeight + 120;\n        setAutocompletePos({ top, left: 10 });\n        setShowAutocomplete(true);\n      }\n    } else {\n      setShowAutocomplete(false);\n    }\n  }, []);\n\n  // Handle autocomplete selection\n  const handleAutocompleteSelect = useCallback((varName) => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      const beforeCursor = text.slice(0, cursorPosition);\n      const afterCursor = text.slice(cursorPosition);\n      const newText = beforeCursor + varName + '}}' + afterCursor;\n      setText(newText);\n      setShowAutocomplete(false);\n      \n      setTimeout(() => {\n        textarea.focus();\n        const newCursorPos = cursorPosition + varName.length + 2;\n        textarea.setSelectionRange(newCursorPos, newCursorPos);\n      }, 0);\n    }\n  }, [text, cursorPosition]);\n\n  // Close autocomplete on blur\n  const handleBlur = useCallback(() => {\n    setTimeout(() => setShowAutocomplete(false), 200);\n  }, []);\n\n  return (\n    <BaseNode\n      id={id}\n      title={config.title}\n      icon={config.icon}\n      category={config.category}\n      inputs={allInputs}\n      outputs={config.defaultOutputs}\n      selected={selected}\n      minWidth={dimensions.width}\n      minHeight={dimensions.height}\n    >\n      <div className=\"space-y-2 relative\">\n        <label className=\"text-xs font-medium text-slate-500 uppercase tracking-wide\">\n          Text\n        </label>\n        \n        {/* Help text */}\n        <div className=\"flex items-start gap-1.5 p-1.5 bg-blue-50/50 border border-blue-100 rounded text-[10px] text-blue-600\">\n          <Info className=\"w-3 h-3 flex-shrink-0 mt-0.5\" />\n          <span>Type <code className=\"px-1 bg-blue-100 rounded\">{'{{'}}</code> to insert variables like <code className=\"px-1 bg-blue-100 rounded\">{'{{nodeId.output}}'}</code></span>\n        </div>\n\n        {/* Available variables from other nodes */}\n        {availableVariables.length > 0 && (\n          <div className=\"space-y-1\">\n            <div className=\"text-[10px] font-medium text-slate-400 uppercase\">Available from pipeline:</div>\n            <div className=\"flex flex-wrap gap-1 max-h-[60px] overflow-auto\">\n              {availableVariables.map((v, i) => (\n                <button\n                  key={i}\n                  onClick={() => {\n                    const newText = text + `{{${v.fullName}}}`;\n                    setText(newText);\n                  }}\n                  className=\"text-[10px] px-1.5 py-0.5 bg-slate-50 text-slate-600 border border-slate-200 rounded hover:bg-primary/5 hover:border-primary/30 hover:text-primary transition-colors cursor-pointer font-mono\"\n                  title={`From ${v.nodeType} (${v.nodeId})`}\n                >\n                  {v.fullName}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n        \n        {/* Textarea with autocomplete */}\n        <div className=\"relative\">\n          <textarea\n            ref={textareaRef}\n            value={text}\n            onChange={handleTextChange}\n            onBlur={handleBlur}\n            placeholder='Hello {{input-1.value}}! Type {{ to see variables...'\n            className=\"w-full p-2 text-[11px] font-mono bg-slate-50 border border-slate-200 rounded-md focus:outline-none focus:bg-white focus:border-primary focus:ring-1 focus:ring-primary/20 transition-colors resize-none leading-relaxed nodrag\"\n            style={{ minHeight: Math.max(60, text.split('\\n').length * 18 + 10) }}\n          />\n          \n          {/* Autocomplete dropdown */}\n          {showAutocomplete && (\n            <AutocompleteDropdown\n              variables={availableVariables}\n              onSelect={handleAutocompleteSelect}\n              position={autocompletePos}\n            />\n          )}\n        </div>\n\n        {/* Preview with highlighting */}\n        {text && (\n          <div className=\"p-2 bg-slate-50/50 border border-slate-100 rounded-md\">\n            <div className=\"text-[10px] font-medium text-slate-400 uppercase mb-1\">Preview</div>\n            <HighlightedText text={text} validVars={validVars} invalidVars={[...invalidVars, ...unconnectedVars]} />\n          </div>\n        )}\n\n        {/* Unconnected variables warning */}\n        {unconnectedVars.length > 0 && (\n          <div className=\"flex items-start gap-1.5 p-2 bg-amber-50 border border-amber-100 rounded-md\">\n            <AlertCircle className=\"w-3.5 h-3.5 text-amber-500 flex-shrink-0 mt-0.5\" />\n            <div>\n              <p className=\"text-[10px] font-medium text-amber-700\">\n                Unconnected variables\n              </p>\n              <p className=\"text-[10px] text-amber-600\">\n                {unconnectedVars.map(v => `{{${v}}}`).join(', ')} — connect the source nodes\n              </p>\n            </div>\n          </div>\n        )}\n\n        {/* Invalid variables warning */}\n        {invalidVars.length > 0 && (\n          <div className=\"flex items-start gap-1.5 p-2 bg-red-50 border border-red-100 rounded-md\">\n            <AlertCircle className=\"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5\" />\n            <div>\n              <p className=\"text-[10px] font-medium text-red-700\">\n                Invalid variables\n              </p>\n              <p className=\"text-[10px] text-red-600\">\n                {invalidVars.map(v => `{{${v}}}`).join(', ')} — no matching node output\n              </p>\n            </div>\n          </div>\n        )}\n      </div>\n    </BaseNode>\n  );\n};\n\nexport default TextNode;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}